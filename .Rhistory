diet_comp$nll_diet<-nll_diet
diet_comp$pearson<-((diet_comp$value-diet_comp$pred_diet)/sqrt(diet_comp$pred_diet))
nll_diet
dim(nll_diet)
length(nll_diet)
diet_comp <- hydraDataList$observedSurvDiet %>% tibble()
diet_comp
diet_comp <- hydraDataList$observedSurvDiet %>% tibble()
diet_comp<-diet_comp %>% pivot_longer(cols=6:ncol(.), names_to = "prey") %>%
mutate(#lenbin = as.integer(str_remove(lenbin, "V")),
species = hydraDataList$speciesList[species],
label = rep("diet",nrow(.)))
diet_comp<- diet_comp  %>% filter(value != -999)
pred_diet<-output$pred_dietprop
diet_comp$pred_diet<-pred_diet
pred_diet<-output$pred_dietprop
if (length(pred_diet)!=nrow(diet_comp)) diet_comp <- diet_comp %>% filter(value != 0)
diet_comp$pred_diet<-pred_diet
diet_comp <- hydraDataList$observedSurvDiet %>% tibble()
diet_comp<-diet_comp %>% pivot_longer(cols=6:ncol(.), names_to = "prey") %>%
mutate(#lenbin = as.integer(str_remove(lenbin, "V")),
species = hydraDataList$speciesList[species],
label = rep("diet",nrow(.)))
diet_comp<- diet_comp  %>% filter(value != -999)
pred_diet<-output$pred_dietprop
if (length(pred_diet)!=nrow(diet_comp)) diet_comp <- diet_comp %>% filter(value != 0)
diet_comp$pred_diet<-pred_diet
nll_diet<-output$nll_dietprop
diet_comp$nll_diet<-nll_diet
diet_comp$pearson<-((diet_comp$value-diet_comp$pred_diet)/sqrt(diet_comp$pred_diet))
colnames(diet_comp) <- c('number','year','species','lenbin','InpN','prey','obs_value','label', 'pred_value','nll')
#catch
catchsample <- catch_size %>%
tibble() %>%
mutate(effN_a = pred_value/(1.-pred_value),
effN_b = (obs_value-pred_value)^2) %>%
group_by(number, area, year, species, type) %>%
summarize(InpN = mean(InpN),
effN = sum(effN_a)/sum(effN_b),
.groups = "drop") %>%
I()
catchsample
View(catch_size)
catch_size$EffN<-catchsample
#survey
survsample <- surv_size %>%
tibble() %>%
mutate(effN_a = pred_value/(1.-pred_value),
effN_b = (obs_value-pred_value)^2) %>%
group_by(number, year, species, type) %>%
summarize(InpN = mean(InpN),
effN = sum(effN_a)/sum(effN_b),
.groups = "drop") %>%
I()
survsample
View(catchsample)
#diet comp
dietsample <- diet_comp %>%
tibble() %>%
mutate(effN_a = pred_value/(1.-pred_value),
effN_b = (obs_value-pred_value)^2) %>%
group_by(number, year, species, lenbin) %>%
summarize(InpN = mean(InpN),
effN = sum(effN_a)/sum(effN_b),
.groups = "drop") %>%
I()
View(diet_comp)
diet_comp <- hydraDataList$observedSurvDiet %>% tibble()
diet_comp<-diet_comp %>% pivot_longer(cols=6:ncol(.), names_to = "prey") %>%
mutate(#lenbin = as.integer(str_remove(lenbin, "V")),
species = hydraDataList$speciesList[species],
label = rep("diet",nrow(.)))
diet_comp<- diet_comp  %>% filter(value != -999)
pred_diet<-output$pred_dietprop
if (length(pred_diet)!=nrow(diet_comp)) diet_comp <- diet_comp %>% filter(value != 0)
diet_comp$pred_diet<-pred_diet
nll_diet<-output$nll_dietprop
diet_comp$nll_diet<-nll_diet
diet_comp
View(diet_comp)
colnames(diet_comp) <- c('number','year','species','lenbin','InpN','prey','obs_value','label', 'pred_value','nll')
View(diet_comp)
#catch
catchsample <- catch_size %>%
tibble() %>%
mutate(effN_a = pred_value/(1.-pred_value),
effN_b = (obs_value-pred_value)^2) %>%
group_by(number, area, year, species, type) %>%
summarize(InpN = mean(InpN),
effN = sum(effN_a)/sum(effN_b),
.groups = "drop") %>%
I()
catchsample
#survey
survsample <- surv_size %>%
tibble() %>%
mutate(effN_a = pred_value/(1.-pred_value),
effN_b = (obs_value-pred_value)^2) %>%
group_by(number, year, species, type) %>%
summarize(InpN = mean(InpN),
effN = sum(effN_a)/sum(effN_b),
.groups = "drop") %>%
I()
survsample
#diet comp
dietsample <- diet_comp %>%
tibble() %>%
mutate(effN_a = pred_value/(1.-pred_value),
effN_b = (obs_value-pred_value)^2) %>%
group_by(number, year, species, lenbin) %>%
summarize(InpN = mean(InpN),
effN = sum(effN_a)/sum(effN_b),
.groups = "drop") %>%
I()
dietsample
##### CATCH and SURVEY BIOMASS ######
set.seed(seed = 23)
temp_catch<-catch %>% filter(species == "3" )
yr<-1
year<-unique(catch$year)
catch_sim <- NULL
for (yr in year) {
catch_sim[[yr]] <-  rnorm(100, catch$pred_catch, catch$cv)
}
survey_sim<-rnorm(100, biomass$pred_bio, biomass$cv)
survey_sim
year<-unique(catch$year)
catch_sim <- NULL
for (yr in year) {
catch_sim[[yr]] <-  rnorm(100, catch$pred_catch, catch$cv)
}
survey_sim<-rnorm(100, biomass$pred_bio, biomass$cv)
survey_sim
biomass$pred_bio
biomass$cv
temp_catch<-catch
yr<-1
year<-unique(catch$year)
catch_sim <- NULL
for (yr in year) {
catch_sim[[yr]] <-  rnorm(100, catch$pred_catch, catch$cv)
}
survey_sim<-rnorm(100, biomass$pred_bio, biomass$cv)
survey_sim
catch_sim
yr<-1
year<-unique(catch$year)
catch_sim <- NULL
for (yr in year) {
catch_sim[[yr]] <-  rnorm(100, catch$pred_catch, catch$cv)
}
catch_sim
View(catch_sim)
year
temp_catch<-catch_size
year<-unique(catch_size$year)
year<-unique(catch_size$year)
catch_sim <- NULL
for (yr in year) {
catch_sim[[yr]] <-  rnorm(100, catch_size$pred_catch, catch_size$cv)
}
View(catch_size)
catch_size <- hydraDataList$observedCatchSize %>% tibble()
catch_size<-catch_size %>% pivot_longer(cols=7:ncol(.), names_to = "lenbin") %>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("catch",nrow(.)),
species = hydraDataList$speciesList[species])# %>% filter(value != -999)
catch_size<- catch_size %>% filter(value != -999)
pred_catch<-output$pred_catch_size
pred_catch
output<-reptoRlist(repfile)
source("R/read.report.R")
source("R/gettables.R")
library(tidyverse)
hydraDataList<-readRDS("test-data/hydraDataList_GB5bin.rds")
repfile <- c("test-data/hydra_sim.rep")
output<-reptoRlist(repfile)
output
View(output)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
biorows <- dim(obs_surveyB)[1]
catchrows <- dim(obs_catchB)[1]
repfile
indexfits <- gettables(repfile, biorows, catchrows)
View(indexfits)
indexfits[[1]]
indexfits[[2]]
source("R/read.report.R")
source("R/gettables.R")
library(tidyverse)
hydraDataList<-readRDS("test-data/hydraDataList_GB5bin.rds")
repfile <- c("test-data/hydra_sim.rep")
output<-reptoRlist(repfile)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
View(obs_surveyB)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
biorows <- dim(obs_surveyB)[1]
catchrows <- dim(obs_catchB)[1]
indexfits <- gettables(repfile, biorows, catchrows)
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
biomass
hydraDataList$speciesList
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])%>%
filter(species == "Atlantic_mackerel"|"Spiny_dogfish"|"Atlantic_herring"|"Atlantic_cod" )
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
biomass<- biomass %>% filter(species == "Atlantic_mackerel"|"Spiny_dogfish"|"Atlantic_herring"|"Atlantic_cod" )
biomass<- biomass %>% filter(species = "Atlantic_mackerel"|"Spiny_dogfish"|"Atlantic_herring"|"Atlantic_cod" )
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
biomass<- biomass$species %>% filter("Atlantic_mackerel"|"Spiny_dogfish"|"Atlantic_herring"|"Atlantic_cod" )
biomass<- biomass %>% filter(species="Atlantic_mackerel"|"Spiny_dogfish"|"Atlantic_herring"|"Atlantic_cod" )
biomass<- biomass %>% filter(species=="Atlantic_mackerel"|"Spiny_dogfish"|"Atlantic_herring"|"Atlantic_cod" )
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
catch<-indexfits[[2]]%>%
mutate(species = hydraDataList$speciesList[species])
biomass
biomass<- biomass$species %<% filter("Spiny_dogfish")
biomass<- biomass$species %>% filter("Spiny_dogfish")
View(biomass)
biomass$species
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
catch<-indexfits[[2]]%>%
mutate(species = hydraDataList$speciesList[species])
biomass$species[Spiny_dogfish]
biomass$species["Spiny_dogfish"]
View(biomass)
source("R/read.report.R")
source("R/gettables.R")
library(tidyverse)
#read new 4 species 5 bins data
hydraDataList <- readRDS("inputs/hydra_sim_GBself_5bin.rds")
setwd("C:/Users/macristina.perez/Documents/UMassD/Classes/2022/fall_2022/EBFM/project")
#read new 4 species 5 bins data
hydraDataList <- readRDS("inputs/hydra_sim_GBself_5bin.rds")
View(hydraDataList_GB5bin)
hydraDataList_GB5bin[["speciesList"]]
repfile <- c("inputs/hydra_sim.rep")
output<-reptoRlist(repfile)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
biorows <- dim(obs_surveyB)[1]
obs_catchB <- hydraDataList$observedCatch
catchrows <- dim(obs_catchB)[1]
indexfits <- gettables(repfile, biorows, catchrows)
biomass<-indexfits[[1]]
catch<-indexfits[[2]]
obs_survey <- hydraDataList$observedSurvSize %>% tibble()
obs_survey <- obs_survey %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
obs_survey$value[which(obs_survey$value == -999)] = 0.00001
pred_surv<-output$pred_survey_size
obs_survey$pred_surv<-pred_surv
nll_survey<-output$nll_survey_size
colnames(obs_survey) <- c('number','year','species','type','InpN','lenbin','obs_value','label',
'pred_value','nll','pearson')
obs_catch <- hydraDataList$observedCatchSize %>% tibble()
obs_catch<-obs_catch %>% pivot_longer(cols=7:ncol(.), names_to = "lenbin") %>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("catch",nrow(.)),
species = hydraDataList$speciesList[species])# %>% filter(value != -999)
obs_catch$value[which(obs_catch$value == -999)] = 0.00001
pred_catch<-output$pred_catch_size
obs_catch$pred_catch<-pred_catch
nll_catch<-output$nll_catch_size
obs_catch <- hydraDataList$observedCatchSize %>% tibble()
obs_catch<-obs_catch %>% pivot_longer(cols=7:ncol(.), names_to = "lenbin") %>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("catch",nrow(.)),
species = hydraDataList$speciesList[species]) %>% filter(value != -999)
pred_catch<-output$pred_catch_size
obs_catch$pred_catch<-pred_catch
source("R/read.report.R")
source("R/gettables.R")
library(tidyverse)
hydraDataList<-readRDS("test-data/hydraDataList_GB5bin.rds")
setwd("C:/Users/macristina.perez/Documents/UMassD/Classes/2022/fall_2022/EBFM/project/project2")
hydraDataList<-readRDS("test-data/hydraDataList_GB5bin.rds")
repfile <- c("test-data/hydra_sim.rep")
output<-reptoRlist(repfile)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
biorows <- dim(obs_surveyB)[1]
catchrows <- dim(obs_catchB)[1]
indexfits <- gettables(repfile, biorows, catchrows)
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
catch<-indexfits[[2]]%>%
mutate(species = hydraDataList$speciesList[species])
surv_size <- hydraDataList$observedSurvSize %>% tibble()
surv_size <- surv_size %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
surv_size<- surv_size %>% filter(value != -999)
pred_surv<-output$pred_survey_size
surv_size$pred_surv<-pred_surv
surv_size <- hydraDataList$observedSurvSize %>% tibble()
surv_size <- surv_size %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
#surv_size<- surv_size %>% filter(value != -999)
surv_size$value[which(surv_size$value == -999)] = 0.00001
pred_surv<-output$pred_survey_size
surv_size$pred_surv<-pred_surv
hydraDataList<-readRDS("test-data/hydraDataList_GB5bin.rds")
repfile <- c("test-data/hydra_sim.rep")
output<-reptoRlist(repfile)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
biorows <- dim(obs_surveyB)[1]
catchrows <- dim(obs_catchB)[1]
indexfits <- gettables(repfile, biorows, catchrows)
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
catch<-indexfits[[2]]%>%
mutate(species = hydraDataList$speciesList[species])
surv_size <- hydraDataList$observedSurvSize %>% tibble()
surv_size <- surv_size %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
#surv_size<- surv_size %>% filter(value != -999)
surv_size$value[which(surv_size$value == -999)] = 0.00001
pred_surv<-output$pred_survey_size
surv_size$pred_surv<-pred_surv
hydraDataList<-readRDS("test-data/hydraDataList_GB5bin.rds")
repfile <- c("test-data/hydra_sim.rep")
output<-reptoRlist(repfile)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
biorows <- dim(obs_surveyB)[1]
catchrows <- dim(obs_catchB)[1]
indexfits <- gettables(repfile, biorows, catchrows)
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
catch<-indexfits[[2]]%>%
mutate(species = hydraDataList$speciesList[species])
surv_size <- hydraDataList$observedSurvSize %>% tibble()
surv_size <- surv_size %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
surv_size<- surv_size %>% filter(value != -999)
pred_surv<-output$pred_survey_size
surv_size$pred_surv<-pred_surv
surv_size <- hydraDataList$observedSurvSize %>% tibble()
surv_size <- surv_size %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
surv_size<- surv_size %>% filter(value != -999)
View(surv_size)
surv_size <- hydraDataList$observedSurvSize %>% tibble()
surv_size <- surv_size %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
View(surv_size)
pred_surv<-output$pred_survey_size
surv_size$pred_surv<-pred_surv
source("R/read.report.R")
source("R/gettables.R")
library(tidyverse)
hydraDataList_5bin <- readRDS("C:/Users/macristina.perez/Documents/GitHub/hydra_sim/inputRdatalists/hydraDataList_5bin.rds")
hydraDataList<-hydraDataList_5bin
repfile <- c("test-data/hydra_sim.rep")
output<-reptoRlist(repfile)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
biorows <- dim(obs_surveyB)[1]
catchrows <- dim(obs_catchB)[1]
indexfits <- gettables(repfile, biorows, catchrows)
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
catch<-indexfits[[2]]%>%
mutate(species = hydraDataList$speciesList[species])
View(biomass)
source("R/read.report.R")
source("R/gettables.R")
library(tidyverse)
load("test-data/hydraDataList.rda")
repfile <- c("test-data/hydra_sim.rep")
output<-reptoRlist(repfile)
### CATCH AND SURVEY BIOMASS ###
obs_surveyB <- hydraDataList$observedBiomass
obs_catchB <- hydraDataList$observedCatch
biorows <- dim(obs_surveyB)[1]
catchrows <- dim(obs_catchB)[1]
indexfits <- gettables(repfile, biorows, catchrows)
biomass<-indexfits[[1]] %>%
mutate(species = hydraDataList$speciesList[species])
catch<-indexfits[[2]]%>%
mutate(species = hydraDataList$speciesList[species])
pred_catch <- catch$pred_catch
cv_catch<-catch$cv
# create simulation object
sim_data <- NULL
isim <- 1
# replace index with simulated data
sim_list <- NULL
sim_list$catch <- obs_catchB %>%
mutate(obs = rnorm(nrow(.), pred_catch, cv_catch))
sim_data[[isim]] <- sim_list
pred_survey <- biomass$pred_bio
cv_survey<-biomass$cv
sim_list$survey <- obs_surveyB %>%
mutate(obs = (rnorm(nrow(.), pred_survey, cv_survey)))
# store simulated object
sim_data[[isim]] <- sim_list
catch_size <- hydraDataList$observedCatchSize %>% tibble()
catch_size<-catch_size %>% pivot_longer(cols=7:ncol(.), names_to = "lenbin") %>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("catch",nrow(.)),
species = hydraDataList$speciesList[species])# %>% filter(value != -999)
#catch_size<- catch_size %>% filter(value != -999)
catch_size$value[which(catch_size$value == -999)] = 0.000001
catch_size <- select(catch_size, -label)
pred_catchsize<-output$pred_catch_size
nll_catch<-output$nll_catch_size
sim_list$catch_size
temporal1 = numeric()
especie = numeric(); especie = sort(unique(catch_size$species)) # especies
for(e in 1:length(especie)){
pos1 = numeric(); pos1 = which(catch_size$species == especie[e])
year = numeric(); year = sort(unique(catch_size$year[pos1]))
for(y in 1:length(year)){
pos2 = numeric(); pos2 = which(catch_size$year[pos1]== year[y])
temp = numeric(); temp = rmultinom(1, unique(catch_size$inpN[pos1][pos2]), pred_catchsize[pos1][pos2])
temporal1 = c(temporal1, temp)
}
}
catch_size$obs = temporal1
sim_list$catchsize<-catch_size
surv_size <- hydraDataList$observedSurvSize %>% tibble()
surv_size <- surv_size %>% pivot_longer(cols=6:ncol(.), names_to = "lenbin") %>% #filter(value != -999)%>%
mutate(lenbin = as.integer(str_remove(lenbin, "sizebin")),
label = rep("survey",nrow(.)),
species = hydraDataList$speciesList[species])
#surv_size<- surv_size %>% filter(value != -999)
surv_size$value[which(surv_size$value == -999)] = 0.000001
surv_size <- select(surv_size, -label)
pred_survsize<-output$pred_survey_size
nll_survey<-output$nll_survey_size
sim_list$surv_size
temporal1 = numeric()
number = numeric(); number = sort(unique(surv_size$survey))
for (n in 1:length(number)) {
pos0 = numeric(); pos0 = which(surv_size$survey == number[n])
especie = numeric(); especie = sort(unique(surv_size$species[pos0])) # especies
for(e in 1:length(especie)){
pos1 = numeric(); pos1 = which(surv_size$species[pos0] == especie[e])
year = numeric(); year = sort(unique(surv_size$year[pos0][pos1]))
for(y in 1:length(year)){
pos2 = numeric(); pos2 = which(surv_size$year[pos0][pos1]== year[y])
temp = numeric(); temp = rmultinom(1, unique(surv_size$inpN[pos0][pos1][pos2]), pred_survsize[pos0][pos1][pos2])
temporal1 = c(temporal1, temp)
}
}
}
surv_size$obs = temporal1
sim_list$survsize<-surv_size
diet_comp <- hydraDataList$observedSurvDiet %>% tibble()
diet_comp<-diet_comp %>% pivot_longer(cols=6:ncol(.), names_to = "prey") %>%
mutate(#lenbin = as.integer(str_remove(lenbin, "V")),
species = hydraDataList$speciesList[species],
label = rep("diet",nrow(.)))
diet_comp$value[which(diet_comp$value == -999)] = 0.000001
diet_comp <- select(diet_comp, -label)
pred_diet<-output$pred_dietprop
if (length(pred_diet)!=nrow(diet_comp)) diet_comp <- diet_comp %>% filter(value != 0)
nll_diet<-output$nll_dietprop
sim_list$diet_comp
temporal1 = numeric()
number = numeric(); number = sort(unique(diet_comp$survey))
for (n in 1:length(number)) {
pos0 = numeric(); pos0 = which(diet_comp$survey == number[n])
especie = numeric(); especie = sort(unique(diet_comp$species[pos0])) # especies
for(e in 1:length(especie)){
pos1 = numeric(); pos1 = which(diet_comp$species[pos0] == especie[e])
year = numeric(); year = sort(unique(diet_comp$year[pos0][pos1]))
for(y in 1:length(year)){
pos2 = numeric(); pos2 = which(diet_comp$year[pos0][pos1]== year[y])
lenbin = numeric(); lenbin = sort(unique(diet_comp$sizebin[pos0][pos1][pos2]))
for(l in 1:length(lenbin)){
pos3 = numeric(); pos3 = which(diet_comp$sizebin[pos0][pos1][pos2] == lenbin[l])
temp = numeric(); temp = rmultinom(1, unique(diet_comp$inpN[pos0][pos1][pos2][pos3]), pred_diet[pos0][pos1][pos2][pos3])
temporal1 = c(temporal1, temp)
}
}
}
}
diet_comp$obs = temporal1
sim_list$dietcomp<-diet_comp
View(sim_list)
